# åç«¯å®ç°å®Œæˆæ€»ç»“

## âœ… å·²å®Œæˆçš„å·¥ä½œ

### 1. **model_trainer.py** - æ¨¡å‹è®­ç»ƒæ¥å£

**æ”¹è¿›ï¼š**
- âœ… å®Œæ•´çš„å‚æ•°éªŒè¯å’Œé”™è¯¯å¤„ç†
- âœ… æ”¯æŒSyncTalkå’ŒGaussianTalkerä¸¤ç§æ¨¡å‹
- âœ… å®æ—¶è¾“å‡ºè®­ç»ƒæ—¥å¿—
- âœ… è¿”å›ç»“æ„åŒ–ç»“æœï¼ˆstatus, model_name, model_dirç­‰ï¼‰
- âœ… è‡ªåŠ¨å¤„ç†epoch/iterationså‚æ•°å·®å¼‚

**å…³é”®åŠŸèƒ½ï¼š**
```python
# GaussianTalkerè®­ç»ƒæµç¨‹ï¼š
# 1. å‚æ•°éªŒè¯ï¼ˆè§†é¢‘è·¯å¾„ã€GPUã€è¿­ä»£æ•°ã€é…ç½®æ–‡ä»¶ï¼‰
# 2. è°ƒç”¨ run_gaussiantalker.sh train
# 3. å®æ—¶æ‰“å°è®­ç»ƒæ—¥å¿—
# 4. è¿”å›è®­ç»ƒç»“æœå’Œæ¨¡å‹è·¯å¾„
```

### 2. **video_generator.py** - è§†é¢‘ç”Ÿæˆæ¥å£

**æ”¹è¿›ï¼š**
- âœ… è‡ªåŠ¨å¤åˆ¶éŸ³é¢‘åˆ°æ•°æ®ç›®å½•
- âœ… è‡ªåŠ¨æå–DeepSpeechç‰¹å¾ï¼ˆç”±è„šæœ¬å¤„ç†ï¼‰
- âœ… å®æ—¶è¾“å‡ºæ¨ç†æ—¥å¿—
- âœ… æ™ºèƒ½æŸ¥æ‰¾ç”Ÿæˆçš„è§†é¢‘ï¼ˆæ”¯æŒoutput.mp4å’Œ.movæ–‡ä»¶ï¼‰
- âœ… è‡ªåŠ¨è½¬æ¢.movä¸º.mp4
- âœ… å¤åˆ¶è§†é¢‘åˆ°staticç›®å½•ä¾›å‰ç«¯è®¿é—®

**å…³é”®åŠŸèƒ½ï¼š**
```python
# GaussianTalkeræ¨ç†æµç¨‹ï¼š
# 1. å¤åˆ¶éŸ³é¢‘åˆ° GaussianTalker/data/{model}/
# 2. è°ƒç”¨ run_gaussiantalker.sh infer
# 3. æŸ¥æ‰¾ç”Ÿæˆçš„è§†é¢‘ (output.mp4 æˆ– renders.mov)
# 4. è½¬æ¢æ ¼å¼ï¼ˆå¦‚éœ€è¦ï¼‰
# 5. å¤åˆ¶åˆ° static/videos/
```

### 3. **chat_engine.py** - å®æ—¶å¯¹è¯ç³»ç»Ÿ

**å®Œæ•´çš„4æ­¥æµç¨‹ï¼š**
```
ç”¨æˆ·å½•éŸ³ 
    â†“
1. ASR (speech_recognition)
   - Googleè¯­éŸ³è¯†åˆ«
   - è¾“å‡ºï¼šinput.txt
    â†“
2. LLM (æ™ºè°±AI)
   - glm-4-plusæ¨¡å‹
   - è¾“å‡ºï¼šoutput.txt
    â†“
3. TTS (å¾…å®ç°ï¼Œç°ç”¨ä¸´æ—¶æ–¹æ¡ˆ)
   - âš ï¸ ç›®å‰ä½¿ç”¨è®­ç»ƒéŸ³é¢‘ä½œä¸ºä¸´æ—¶æ–¹æ¡ˆ
   - TODO: é›†æˆCoqui TTSè¿›è¡ŒçœŸæ­£çš„è¯­éŸ³å…‹éš†
   - è¾“å‡ºï¼šoutput.wav
    â†“
4. GaussianTalker (æ•°å­—äººç”Ÿæˆ)
   - è°ƒç”¨æ¨ç†ç”Ÿæˆè§†é¢‘
   - è¾“å‡ºï¼šchat_response.mp4
```

**TODO: TTSè¯­éŸ³å…‹éš†**
```python
# éœ€è¦é›†æˆä¸“ä¸šTTSå¼•æ“ï¼Œå»ºè®®ä½¿ç”¨Coqui TTS:
from TTS.api import TTS
tts = TTS("tts_models/multilingual/multi-dataset/xtts_v2")
tts.tts_to_file(
    text=output_text,
    speaker_wav="./GaussianTalker/data/obama/aud.wav",  # å‚è€ƒéŸ³è‰²
    language="zh",
    file_path="./static/audios/output.wav"
)
```

### 4. **å‰ç«¯é¡µé¢æ›´æ–°**

**å·²æ›´æ–°ï¼š**
- âœ… model_training.html - æ·»åŠ GaussianTalkeré€‰é¡¹
- âœ… video_generation.html - æ·»åŠ GaussianTalkeré€‰é¡¹
- âœ… chat_system.html - æ·»åŠ GaussianTalkeré€‰é¡¹
- âœ… æ·»åŠ å‚æ•°è¯´æ˜ï¼ˆepoch vs iterationsï¼‰

---

## ğŸ§ª æµ‹è¯•æŒ‡å—

### å‡†å¤‡å·¥ä½œ

1. **ç¡®ä¿Dockeré•œåƒå·²æ„å»º**
```bash
docker images | grep gaussiantalker
# åº”è¯¥çœ‹åˆ°: gaussiantalker:latest
```

2. **å‡†å¤‡æµ‹è¯•æ•°æ®**
```bash
# è®­ç»ƒè§†é¢‘ï¼ˆ3-5åˆ†é’Ÿï¼Œå•äººè¯´è¯ï¼‰
mkdir -p test_data
cp /path/to/obama.mp4 test_data/

# æµ‹è¯•éŸ³é¢‘ï¼ˆç”¨äºæ¨ç†ï¼‰
cp /path/to/test_audio.wav test_data/
```

3. **å¯åŠ¨Flaskåº”ç”¨**
```bash
cd TFG_ui_GaussianTalker
python app.py
# åº”è¯¥åœ¨ http://localhost:5001 å¯åŠ¨
```

### æµ‹è¯•1ï¼šæ¨¡å‹è®­ç»ƒ

**è®¿é—®**: http://localhost:5001/model_training

**æ“ä½œ**:
1. é€‰æ‹©æ¨¡å‹ï¼šGaussianTalker
2. å‚è€ƒè§†é¢‘ï¼štest_data/obama.mp4
3. GPUé€‰æ‹©ï¼šGPU 0
4. è®­ç»ƒè½®æ•°ï¼š2000ï¼ˆå¿«é€Ÿæµ‹è¯•ï¼‰
5. ç‚¹å‡»"Training!"

**é¢„æœŸç»“æœ**:
```
- åç«¯æ—¥å¿—åº”è¯¥æ˜¾ç¤ºè®­ç»ƒè¿›åº¦
- è®­ç»ƒæ—¶é—´ï¼šçº¦30-40åˆ†é’Ÿï¼ˆ2000æ¬¡è¿­ä»£ï¼‰
- æˆåŠŸååº”è¯¥åœ¨ GaussianTalker/data/obama/ çœ‹åˆ°é¢„å¤„ç†æ•°æ®
- æ¨¡å‹ä¿å­˜åœ¨ GaussianTalker/output/obama/
```

**éªŒè¯**:
```bash
# æ£€æŸ¥é¢„å¤„ç†æ•°æ®
ls -la GaussianTalker/data/obama/
# åº”è¯¥çœ‹åˆ°ï¼š
# - ori_imgs/ gt_imgs/ parsing/ torso_imgs/
# - au.csv  â† OpenFaceç”Ÿæˆçš„AUç‰¹å¾ï¼ˆå…³é”®ï¼ï¼‰
# - aud.wav, aud_ds.npy
# - transforms_train.json, transforms_val.json

# æ£€æŸ¥æ¨¡å‹
ls -la GaussianTalker/output/obama/
# åº”è¯¥çœ‹åˆ°ï¼š
# - point_cloud/iteration_2000/
```

### æµ‹è¯•2ï¼šè§†é¢‘ç”Ÿæˆ

**è®¿é—®**: http://localhost:5001/video_generation

**æ“ä½œ**:
1. é€‰æ‹©æ¨¡å‹ï¼šGaussianTalker
2. æ¨¡å‹ç›®å½•ï¼šobama
3. å‚è€ƒéŸ³é¢‘ï¼štest_data/test_audio.wav
4. GPUé€‰æ‹©ï¼šGPU 0
5. ç‚¹å‡»"ç”Ÿæˆè§†é¢‘"

**é¢„æœŸç»“æœ**:
```
- æ¨ç†æ—¶é—´ï¼šçº¦5-10ç§’
- ç”Ÿæˆè§†é¢‘ä¿å­˜åœ¨ static/videos/obama_test_audio.mp4
- å‰ç«¯è‡ªåŠ¨æ’­æ”¾ç”Ÿæˆçš„è§†é¢‘
```

**éªŒè¯**:
```bash
# æ£€æŸ¥ç”Ÿæˆçš„è§†é¢‘
ls -la static/videos/obama_test_audio.mp4

# æ’­æ”¾è§†é¢‘æ£€æŸ¥è´¨é‡
vlc static/videos/obama_test_audio.mp4
# æˆ–åœ¨æµè§ˆå™¨ä¸­æŸ¥çœ‹
```

### æµ‹è¯•3ï¼šå®æ—¶å¯¹è¯

**è®¿é—®**: http://localhost:5001/chat_system

**æ“ä½œ**:
1. å½•åˆ¶è¯­éŸ³ï¼ˆè¯´ä¸€å¥è¯ï¼‰
2. é€‰æ‹©æ¨¡å‹ï¼šGaussianTalker
3. æ¨¡å‹ç›®å½•ï¼šobama
4. ç‚¹å‡»"å¼€å§‹å¯¹è¯"

**é¢„æœŸç»“æœ**:
```
- ASRè¯†åˆ«ä½ çš„è¯­éŸ³
- LLMç”Ÿæˆå›å¤
- TTSåˆæˆè¯­éŸ³ï¼ˆç›®å‰æ˜¯ä¸´æ—¶æ–¹æ¡ˆï¼‰
- GaussianTalkerç”Ÿæˆæ•°å­—äººè§†é¢‘
- å‰ç«¯æ’­æ”¾å¯¹è¯è§†é¢‘
```

**å½“å‰é™åˆ¶**:
- âš ï¸ TTSä½¿ç”¨ä¸´æ—¶æ–¹æ¡ˆï¼ˆå¤åˆ¶è®­ç»ƒéŸ³é¢‘ï¼‰ï¼Œä¸æ˜¯çœŸæ­£çš„è¯­éŸ³å…‹éš†
- âš ï¸ éœ€è¦å®ç°ä¸“ä¸šTTSå¼•æ“æ‰èƒ½çœŸæ­£è¯´å‡ºAIçš„å›å¤å†…å®¹

---

## ğŸ› å¯èƒ½çš„é—®é¢˜

### é—®é¢˜1ï¼šè®­ç»ƒå¤±è´¥ï¼Œæ‰¾ä¸åˆ°au.csv

**åŸå› **: OpenFaceæœªæ­£ç¡®å®‰è£…æˆ–è°ƒç”¨å¤±è´¥

**æ£€æŸ¥**:
```bash
# éªŒè¯Dockerä¸­çš„OpenFace
docker run --rm gaussiantalker:latest FeatureExtraction -h

# æ£€æŸ¥é¢„å¤„ç†è„šæœ¬
grep -n "FeatureExtraction" GaussianTalker/data_utils/process.py
```

**è§£å†³**: ç¡®ä¿Dockerfile.finalä¸­çš„OpenFaceç¼–è¯‘æˆåŠŸ

### é—®é¢˜2ï¼šæ¨ç†æ‰¾ä¸åˆ°è§†é¢‘

**åŸå› **: è§†é¢‘è·¯å¾„ä¸å¯¹æˆ–æ ¼å¼è½¬æ¢å¤±è´¥

**æ£€æŸ¥**:
```bash
# æŸ¥çœ‹rendersç›®å½•
ls -la GaussianTalker/output/obama/custom/ours_2000/renders/

# åº”è¯¥çœ‹åˆ°ï¼š
# - obama_custom_2000iter_renders.mov
# - output.mp4ï¼ˆç”±è„šæœ¬è½¬æ¢ç”Ÿæˆï¼‰
```

**è§£å†³**: æ£€æŸ¥run_gaussiantalker.shä¸­çš„è§†é¢‘è½¬æ¢é€»è¾‘

### é—®é¢˜3ï¼šGPUä¸å¯ç”¨

**åŸå› **: Dockeræœªæ­£ç¡®æŒ‚è½½GPU

**æ£€æŸ¥**:
```bash
# æµ‹è¯•GPUè®¿é—®
docker run --rm --gpus device=0 gaussiantalker:latest python -c "import torch; print(torch.cuda.is_available())"
# åº”è¯¥è¾“å‡ºï¼šTrue
```

**è§£å†³**: ç¡®ä¿Dockeræœ‰--gpusæƒé™ï¼Œæ£€æŸ¥nvidia-dockeræ˜¯å¦å®‰è£…

### é—®é¢˜4ï¼šå®æ—¶å¯¹è¯TTSæ•ˆæœå·®

**åŸå› **: ç›®å‰ä½¿ç”¨ä¸´æ—¶æ–¹æ¡ˆï¼Œä¸æ˜¯çœŸæ­£çš„TTS

**è§£å†³**: éœ€è¦é›†æˆCoqui TTSæˆ–å…¶ä»–ä¸“ä¸šTTSå¼•æ“

---

## ğŸ“Š æ€§èƒ½é¢„æœŸ

### è®­ç»ƒæ€§èƒ½
- 2000æ¬¡è¿­ä»£ï¼š30-40åˆ†é’Ÿï¼ˆRTX 3090ï¼‰
- 10000æ¬¡è¿­ä»£ï¼š2-3å°æ—¶

### æ¨ç†æ€§èƒ½
- å•ä¸ª25fpsè§†é¢‘ï¼š5-10ç§’
- å–å†³äºbatch_sizeå’Œè§†é¢‘é•¿åº¦

### å¯¹è¯ç³»ç»Ÿ
- ASRï¼š1-2ç§’
- LLMï¼š2-3ç§’
- TTSï¼š1-2ç§’ï¼ˆçœŸæ­£çš„TTSï¼‰
- GaussianTalkerï¼š5-10ç§’
- **æ€»è®¡**ï¼šçº¦10-20ç§’

---

## ğŸ¯ ä¸‹ä¸€æ­¥å·¥ä½œ

### å¿…åšï¼ˆäº¤ä»˜å‰ï¼‰
1. âœ… æµ‹è¯•å®Œæ•´è®­ç»ƒæµç¨‹
2. âœ… æµ‹è¯•å®Œæ•´æ¨ç†æµç¨‹
3. â³ éªŒè¯Dockerå°è£…æ˜¯å¦æˆåŠŸï¼ˆç­‰æµ‹è¯•åŒå­¦åé¦ˆï¼‰
4. â³ å‡†å¤‡æ¼”ç¤ºæ•°æ®å’Œè§†é¢‘

### å¯é€‰ï¼ˆæ”¹è¿›ï¼‰
1. é›†æˆçœŸæ­£çš„TTSå¼•æ“ï¼ˆCoqui TTSï¼‰
2. æ·»åŠ è¿›åº¦æ¡å’ŒçŠ¶æ€åé¦ˆ
3. æ”¯æŒå¤šæ¨¡å‹åˆ‡æ¢
4. æ·»åŠ æ¨¡å‹ç®¡ç†ç•Œé¢

### æ–‡æ¡£
1. âœ… åç«¯APIæ–‡æ¡£
2. âœ… æµ‹è¯•æŒ‡å—
3. â³ ç»™åŠ©æ•™çš„ä½¿ç”¨è¯´æ˜
4. â³ éƒ¨ç½²æ–‡æ¡£

---

## ğŸ‰ æ€»ç»“

**å·²å®Œæˆï¼š**
- âœ… å®Œæ•´çš„åç«¯é€»è¾‘ï¼ˆè®­ç»ƒã€æ¨ç†ã€å¯¹è¯ï¼‰
- âœ… å‰ç«¯GaussianTalkeré€‰é¡¹
- âœ… Dockerå°è£…æ–¹æ¡ˆ
- âœ… è¯¦ç»†çš„æ–‡æ¡£

**å¾…æµ‹è¯•ï¼š**
- â³ Dockeré•œåƒæ˜¯å¦èƒ½æ­£å¸¸è¿è¡Œ
- â³ å®Œæ•´æµç¨‹æ˜¯å¦é¡ºç•…
- â³ æ€§èƒ½æ˜¯å¦è¾¾æ ‡

**å¾…æ”¹è¿›ï¼š**
- âš ï¸ TTSè¯­éŸ³å…‹éš†ï¼ˆç›®å‰æ˜¯ä¸´æ—¶æ–¹æ¡ˆï¼‰
- âš ï¸ å‰ç«¯UIä¼˜åŒ–
- âš ï¸ é”™è¯¯å¤„ç†å’Œç”¨æˆ·æç¤º

---

**å½“å‰çŠ¶æ€ï¼š** åç«¯å¼€å‘å®Œæˆï¼Œç­‰å¾…æµ‹è¯•éªŒè¯ï¼

**ä¸‹ä¸€æ­¥ï¼š** æµ‹è¯•åŒå­¦æ„å»ºDockeré•œåƒ â†’ è¿è¡Œå®Œæ•´æµç¨‹æµ‹è¯• â†’ ä¿®å¤bug â†’ å‡†å¤‡äº¤ä»˜

